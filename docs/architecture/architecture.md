# ğŸ—ï¸ System Architecture (Public & Professional Edition)

æœ¬æ–‡ä»¶å±•ç¤º **Jinsie AI Agent Platform** çš„æ•´ä½“ç³»ç»Ÿæ¶æ„ï¼Œç”¨äºå…¬å¼€å±•ç¤ºé¡¹ç›®å·¥ç¨‹èƒ½åŠ›ã€æ¨¡å—ç»„ç»‡æ–¹å¼ä¸æŠ€æœ¯è·¯çº¿ã€‚  
æœ¬ç‰ˆæœ¬ä¸åŒ…å«ä»»ä½•éšç§ä¿¡æ¯ï¼Œé€‚åˆ GitHub ä¸å¤§å‚é¢è¯•ä½¿ç”¨ã€‚

---

# ğŸ“ 1. Architecture Overview

ç³»ç»Ÿé‡‡ç”¨ **â€œAPI å±‚ â†’ åº”ç”¨å±‚ï¼ˆLLM / RAG / Agentï¼‰ â†’ å‘é‡ä¸æ•°æ®å±‚ â†’ åŸºç¡€è®¾æ–½å±‚â€** çš„åˆ†å±‚æ¶æ„ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  API Layer                    â”‚
â”‚        (FastAPI Â· RESTful Endpoints)          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                Application Layer              â”‚
â”‚  â”œâ”€â”€ LLM Module (ChatCompletion / Streaming)  â”‚
â”‚  â”œâ”€â”€ RAG Module (Retriever Â· Ranker Â· Reader) â”‚
â”‚  â”œâ”€â”€ Agent Module (LangGraph State Workflow)  â”‚
â”‚  â””â”€â”€ Tools & Services (Search Â· FunctionCall) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                Vector & Storage               â”‚
â”‚  â”œâ”€â”€ Embedding (Qwen-Embedding / OpenAI)      â”‚
â”‚  â”œâ”€â”€ Vector Store (Milvus / OpenSearch)       â”‚
â”‚  â””â”€â”€ Document Store (chunked text)            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Infrastructure Layer             â”‚
â”‚  â”œâ”€â”€ Docker Containerization                  â”‚
â”‚  â”œâ”€â”€ Logging & Monitoring                     â”‚
â”‚  â”œâ”€â”€ Cloud Deployment (Aliyun Ready)          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

# ğŸ“¦ 2. Module Responsibilities

## **2.1 API Layer**
åŸºäº **FastAPI**ï¼Œç”¨äºï¼š

- æš´éœ²æ ‡å‡†åŒ–ä¼ä¸š API  
- ç»Ÿä¸€å…¥å£ï¼ˆAgent Chat / RAG Queryï¼‰  
- ç”Ÿæˆ Swagger è‡ªåŠ¨æ–‡æ¡£  

ç›®å½•ï¼š`app/api/`

---

## **2.2 LLM Core Layer**

ç”¨äºï¼š

- è°ƒç”¨ ChatCompletion  
- å®ç°æµå¼è¾“å‡ºï¼ˆSSE / Token Streamingï¼‰  
- åŒ…è£…ç»Ÿä¸€çš„æ¨¡å‹è°ƒç”¨æ¥å£  
- æ”¯æŒå¤šæ¨¡å‹è·¯ç”±ï¼ˆQwen / DeepSeek / OpenAIï¼‰

ç›®å½•ï¼š`app/core/llm/`

---

## **2.3 RAG Layer**

åŒ…å«æ£€ç´¢å¢å¼ºç”Ÿæˆçš„å®Œæ•´é“¾è·¯ï¼š

1. æ–‡æ¡£è§£æï¼ˆPDF / Textï¼‰
2. æ–‡æœ¬åˆ†å—ï¼ˆChunkingï¼‰
3. åµŒå…¥ç”Ÿæˆï¼ˆEmbeddingï¼‰
4. å‘é‡åº“ï¼ˆMilvus / OpenSearchï¼‰
5. Top-K æ£€ç´¢  
6. RAG Pipeline ç»„è£…

ç›®å½•ï¼š  
`app/rag/`  
`app/core/vectorstore/`

---

## **2.4 Agent Layerï¼ˆå¤šæ™ºèƒ½ä½“ï¼‰**

åŸºäº LangGraphï¼Œå®ç°ï¼š

- æœ‰çŠ¶æ€å·¥ä½œæµï¼ˆStateGraphï¼‰
- Planner / Worker è§’è‰²åˆ’åˆ†
- å·¥å…·ç³»ç»Ÿè°ƒç”¨ï¼ˆæœç´¢ / RAG æŸ¥è¯¢ï¼‰
- è¿ç»­å¤šæ­¥æ¨ç†ï¼ˆReAct æˆ–å·¥å…·é“¾è·¯ï¼‰

ç›®å½•ï¼š  
`app/agents/`

---

## **2.5 Services & Tools**

æä¾›åŸºç¡€èƒ½åŠ›ï¼š

- æœç´¢å·¥å…·  
- æ•°å­¦è®¡ç®—å·¥å…·  
- è°ƒç”¨å¤–éƒ¨ API  
- å¯æ‰©å±•çš„ Tool Call ä½“ç³»  

ç›®å½•ï¼š  
`app/services/`

---

# ğŸ§­ 3. Key Data Flow

## **3.1 Agent Query Flow**
```
Client â†’ API â†’ Agent Workflow â†’ (Tools: RAG / Calculator / Search)
      â†’ LLM â†’ Response â†’ Client
```

## **3.2 RAG Query Flow**
```
Client â†’ API â†’ RAG Router
      â†’ Retriever â†’ Ranker â†’ Reader(LLM)
      â†’ Response â†’ Client
```

## **3.3 Embedding & Indexing Flow**
```
Uploaded Document â†’ Parser â†’ Chunker
                 â†’ Embedding Model â†’ Vector DB
```

---

# ğŸ§© 4. Technology Choices & Reasons

| ç»„ä»¶ | é€‰å‹ | ç†ç”± |
|------|------|------|
| API | FastAPI | é«˜æ€§èƒ½ã€ç±»å‹å®‰å…¨ã€æ–‡æ¡£è‡ªåŠ¨ç”Ÿæˆ |
| Agent æ¡†æ¶ | LangGraph | çŠ¶æ€æµè½¬å¯è§†åŒ–ã€é€‚åˆä¼ä¸šçº§å¤š Agent |
| LLM | Qwen / DeepSeek / OpenAI | è¦†ç›–å›½äº§äº‘ / æµ·å¤–èƒ½åŠ› |
| Embedding | Qwen-Embedding | é˜¿é‡Œäº‘å…¼å®¹æ€§å¼ºã€å›½å†…å¯ç”¨ |
| å‘é‡åº“ | Milvus / OpenSearch | é«˜æ€§èƒ½ã€ä¼ä¸šé€šç”¨ |
| éƒ¨ç½² | Docker | äº‘åŸç”Ÿéƒ¨ç½²æ ‡å‡† |

---

# ğŸŒ 5. Qwen Enhanced Layerï¼ˆé€šä¹‰å¢å¼ºç‰ˆè®¾è®¡ï¼‰

ä¸ºäº†é€‚é…é˜¿é‡Œäº‘ç”Ÿæ€ï¼Œç³»ç»Ÿæ”¯æŒæ‰©å±•ï¼š

- Qwen å¤šæ¨¡å‹ä½“ç³»ï¼ˆMax / Long / VLï¼‰
- Qwen-Agent èƒ½åŠ›  
- Qwen-Embedding  
- Aliyun OpenSearch  
- é˜¿é‡Œäº‘ Serverless éƒ¨ç½²  

å¢å¼ºç»„ä»¶ç›®å½•ï¼ˆé¢„ç•™ï¼‰ï¼š  
`app/extensions/qwen/`

---

# ğŸ§± 6. Directory Structure (Simplified)

```
app/
  â”œâ”€â”€ api/             # ç»Ÿä¸€æ¥å£å±‚
  â”œâ”€â”€ core/
  â”‚    â”œâ”€â”€ llm/        # æ¨¡å‹è°ƒç”¨
  â”‚    â””â”€â”€ vectorstore/# å‘é‡åº“é€‚é…
  â”œâ”€â”€ rag/             # æ£€ç´¢å¢å¼ºç”Ÿæˆ
  â”œâ”€â”€ agents/          # å¤šæ™ºèƒ½ä½“é€»è¾‘
  â”œâ”€â”€ services/        # å·¥å…·ç³»ç»Ÿ
docs/
  â”œâ”€â”€ assets/          # æ¶æ„å›¾ / æ¼”ç¤º
  â””â”€â”€ roadmap.md       # é¡¹ç›® Roadmapï¼ˆå…¬å¼€ï¼‰
infra/
  â”œâ”€â”€ Dockerfile
  â””â”€â”€ deploy/          # éƒ¨ç½²è„šæœ¬
```

---

# ğŸš€ 7. Future Extensions

- å¤šæ¨¡æ€ï¼ˆå›¾ç‰‡/éŸ³é¢‘ï¼‰è¾“å…¥  
- Agent å·¥å…·å¸‚åœº  
- Online Fine-tuning  
- ç›‘æ§ä¸å¯è§‚å¯Ÿæ€§ï¼ˆGrafana / Prometheusï¼‰  
- ä¼ä¸šçº§æƒé™ç³»ç»Ÿ  

---

# âœ… 8. Summary

æœ¬æ¶æ„æ–‡æ¡£æä¾›ï¼š

- æ¨¡å—åŒ–è®¾è®¡  
- æ ‡å‡†åŒ–é“¾è·¯  
- ä¼ä¸šçº§å¯å¤ç”¨ç»“æ„  
- å¯æŒç»­æ‰©å±•çš„å·¥ç¨‹ä½“ç³»  
- é€šä¹‰åƒé—®å¢å¼ºèƒ½åŠ›é¢„ç•™  

é€‚åˆå…¬å¼€å±•ç¤ºï¼Œé€‚é…é˜¿é‡Œäº‘ã€å­—èŠ‚ã€è…¾è®¯ç­‰äº‘å‚å•†çš„å·¥ç¨‹åŒ–å®¡é˜…æ ‡å‡†ã€‚
